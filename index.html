<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NANO FINAL SYSTEM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #000; color: white; }
        
        /* ØªØ£Ø«ÙŠØ± Ø­Ø±ÙƒØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ */
        @keyframes kenburns {
            0% { transform: scale(1) translate(0, 0); }
            50% { transform: scale(1.1) translate(-1%, -1%); }
            100% { transform: scale(1) translate(0, 0); }
        }
        .video-effect {
            animation: kenburns 15s ease-in-out infinite alternate;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .loader {
            border: 4px solid rgba(255,255,255,0.1);
            border-left-color: #3b82f6;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <div class="bg-red-900 text-center p-2 text-xs text-white font-bold">
        âš  Ù‡Ø§Ù…: ØªØ£ÙƒØ¯ÙŠ Ù…Ù† Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ÙˆØ±ÙØ¹ ØµÙˆØª Ø§Ù„Ø¬Ù‡Ø§Ø²
    </div>

    <div class="max-w-3xl mx-auto w-full p-6 flex-1 flex flex-col">
        
        <div class="flex justify-between items-center mb-8 border-b border-gray-800 pb-4">
            <h1 class="text-3xl font-bold text-blue-500">NANO <span class="text-white text-lg">AI</span></h1>
            <button onclick="enableAudio()" id="audioBtn" class="bg-gray-800 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-all flex items-center gap-2">
                <span>ğŸ”Š ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª</span>
            </button>
        </div>

        <div id="displayArea" class="bg-[#111] border border-gray-700 rounded-2xl h-[350px] flex items-center justify-center overflow-hidden relative mb-6">
            <p id="placeholderText" class="text-gray-500">Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (ØµÙˆØ± / ÙÙŠØ¯ÙŠÙˆ / Ø±Ø¯ÙˆØ¯) Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§...</p>
            <div id="contentBox" class="w-full h-full hidden"></div>
        </div>

        <div id="chatResponse" class="bg-[#111] p-4 rounded-xl border border-gray-800 min-h-[80px] mb-6 text-gray-300 text-lg leading-relaxed hidden"></div>

        <div class="mt-auto">
            <textarea id="userInput" class="w-full bg-[#222] text-white p-4 rounded-xl outline-none border border-gray-700 focus:border-blue-500 mb-4 h-24 text-lg resize-none" placeholder="Ø§ÙƒØªØ¨ÙŠ Ù‡Ù†Ø§ (Ù…Ø«Ø§Ù„: Ø£Ø±ÙŠØ¯ ØµÙˆØ±Ø© Ù„Ù‚Ø·Ø©ØŒ Ø£Ùˆ Ù…Ø´Ù‡Ø¯ ÙÙŠØ¯ÙŠÙˆ Ù„Ù„Ø¨Ø­Ø±)..."></textarea>
            
            <div class="grid grid-cols-3 gap-3">
                <button onclick="handleRequest('chat')" class="bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold text-lg transition-all">
                    ğŸ¤ Ù…Ø­Ø§Ø¯Ø«Ø©
                </button>
                <button onclick="handleRequest('image')" class="bg-pink-600 hover:bg-pink-700 text-white py-4 rounded-xl font-bold text-lg transition-all">
                    ğŸ¨ ØµÙˆØ±Ø©
                </button>
                <button onclick="handleRequest('video')" class="bg-purple-600 hover:bg-purple-700 text-white py-4 rounded-xl font-bold text-lg transition-all">
                    ğŸ¬ ÙÙŠØ¯ÙŠÙˆ
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª (Fix Audio) ---
        let audioEnabled = false;
        const synth = window.speechSynthesis;

        function enableAudio() {
            // ØªØ´ØºÙŠÙ„ ØµÙˆØª ØµØ§Ù…Øª Ù„ÙÙƒ Ø§Ù„Ø­Ø¸Ø± Ø¹Ù† Ø§Ù„Ù…ØªØµÙØ­
            const utterance = new SpeechSynthesisUtterance("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¨Ù†Ø¬Ø§Ø­");
            utterance.lang = 'ar-SA';
            synth.speak(utterance);
            audioEnabled = true;
            const btn = document.getElementById('audioBtn');
            btn.innerText = "âœ… Ø§Ù„ØµÙˆØª Ù…ÙØ¹Ù„";
            btn.classList.remove('bg-gray-800');
            btn.classList.add('bg-green-600');
        }

        function speakText(text) {
            if (!audioEnabled) alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø¶ØºØ·ÙŠ Ø²Ø± 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª' Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ø³Ù…Ø§Ø¹ Ø§Ù„Ø±Ø¯!");
            synth.cancel(); // ÙˆÙ‚Ù Ø£ÙŠ ÙƒÙ„Ø§Ù… Ù‚Ø¯ÙŠÙ…
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ar-SA'; 
            utterance.rate = 1; 
            synth.speak(utterance);
        }

        // --- 2. Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ---
        async function handleRequest(type) {
            const input = document.getElementById('userInput').value;
            if (!input && type !== 'chat') return alert("Ø§ÙƒØªØ¨ÙŠ ÙˆØµÙØ§Ù‹ Ø£ÙˆÙ„Ø§Ù‹!");

            const display = document.getElementById('displayArea');
            const content = document.getElementById('contentBox');
            const chatBox = document.getElementById('chatResponse');
            const placeholder = document.getElementById('placeholderText');

            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
            placeholder.innerHTML = '<div class="loader"></div><br><span class="mt-2 text-sm">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</span>';
            content.classList.add('hidden');
            chatBox.classList.add('hidden');

            // --- Ø£: Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© (Chat) ---
            if (type === 'chat') {
                if (!input) {
                   // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø§ÙŠÙƒ Ù„Ùˆ Ø§Ù„Ù†Øµ ÙØ§Ø¶ÙŠ
                   startMic();
                   return;
                }
                
                try {
                    const res = await fetch(`https://text.pollinations.ai/${encodeURIComponent(input)}`);
                    const reply = await res.text();
                    
                    placeholder.innerText = "";
                    chatBox.innerHTML = reply;
                    chatBox.classList.remove('hidden');
                    speakText(reply);
                    
                } catch (e) {
                    placeholder.innerText = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„";
                }
            }

            // --- Ø¨: Ø§Ù„ØµÙˆØ± (Image) ---
            else if (type === 'image') {
                const imgUrl = `https://pollinations.ai/p/${encodeURIComponent(input)}?width=1280&height=720&model=flux&seed=${Math.random()}`;
                
                content.innerHTML = `<img src="${imgUrl}" class="w-full h-full object-contain rounded-lg" onload="imgLoaded()">`;
                content.classList.remove('hidden');
                placeholder.classList.add('hidden');
                speakText("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ");
            }

            // --- Ø¬: Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Video Simulation) ---
            else if (type === 'video') {
                // Ø®Ø¯Ø¹Ø©: Ø¨Ù†Ø¬ÙŠØ¨ ØµÙˆØ±Ø© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆÙ†Ø·Ø¨Ù‚ Ø¹Ù„ÙŠÙ‡Ø§ CSS Animation
                const vidUrl = `https://pollinations.ai/p/${encodeURIComponent(input + " cinematic 8k detailed scene")}&width=1280&height=720&model=flux`;
                
                content.innerHTML = `
                    <div class="w-full h-full overflow-hidden relative rounded-lg">
                        <img src="${vidUrl}" class="video-effect" onload="imgLoaded()">
                        <div class="absolute bottom-4 right-4 bg-red-600 text-white px-2 py-1 text-xs font-bold rounded animate-pulse">REC</div>
                    </div>`;
                
                content.classList.remove('hidden');
                placeholder.classList.add('hidden');
                speakText("Ø¬Ø§Ø±ÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ");
            }
        }

        function imgLoaded() {
            document.getElementById('placeholderText').classList.add('hidden');
        }

        // --- 3. Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† (Speech to Text) ---
        function startMic() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.lang = 'ar-SA';
                recognition.onstart = () => { document.getElementById('placeholderText').innerText = "ğŸ¤ Ø£Ù†Ø§ Ø³Ø§Ù…Ø¹Ùƒ... Ø§ØªÙƒÙ„Ù…ÙŠ"; };
                
                recognition.onresult = (event) => {
                    const txt = event.results[0][0].transcript;
                    document.getElementById('userInput').value = txt;
                    handleRequest('chat'); // Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ
                };
                recognition.start();
            } else {
                alert("Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­ØŒ Ø¬Ø±Ø¨ÙŠ Chrome");
            }
        }
    </script>
</body>
</html>
